---
title: Authentication - Yamify API
---

# Authentication

This page explains how authentication works in the Yamify API, including how to obtain access tokens and how to use them to authenticate API requests.

## Authentication Flow

Yamify uses JSON Web Tokens (JWT) for authentication. The authentication flow works as follows:

1. The client sends credentials to the authentication endpoint
2. The server validates the credentials and returns an access token and refresh token
3. The client includes the access token in subsequent API requests
4. When the access token expires, the client can use the refresh token to obtain a new access token

## Obtaining Access Tokens

### Login Endpoint

To obtain an access token, send a POST request to the login endpoint:

```http
POST /auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "your-password"
}
```

#### Response

```json
{
  "status": "success",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresIn": 3600,
    "user": {
      "id": "usr_12345",
      "username": "johndoe",
      "email": "user@example.com",
      "name": "John Doe",
      "role": "user"
    }
  }
}
```

### Refreshing Access Tokens

When an access token expires, you can use the refresh token to obtain a new one:

```http
POST /auth/refresh
Content-Type: application/json

{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### Response

```json
{
  "status": "success",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresIn": 3600
  }
}
```

## Using Access Tokens

To authenticate API requests, include the access token in the `Authorization` header using the Bearer scheme:

```http
GET /api/v1/users/me
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

## Token Expiration

Access tokens expire after a certain period (typically 1 hour). When a token expires, API requests will return a `401 Unauthorized` response with the following body:

```json
{
  "status": "error",
  "error": {
    "code": "TOKEN_EXPIRED",
    "message": "Access token has expired"
  }
}
```

When this happens, you should refresh the access token using the refresh token as described above.

## OAuth Authentication

In addition to email/password authentication, Yamify supports OAuth authentication with popular providers.

### Google OAuth

To authenticate with Google:

```http
GET /auth/google
```

This will redirect the user to Google's authentication page. After successful authentication, Google will redirect back to your application with an authorization code, which your application can exchange for access and refresh tokens.

### GitHub OAuth

To authenticate with GitHub:

```http
GET /auth/github
```

This works similarly to Google OAuth, redirecting the user to GitHub for authentication.

## Logout

To invalidate a refresh token (logout):

```http
POST /auth/logout
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### Response

```json
{
  "status": "success",
  "message": "Successfully logged out"
}
```

## Error Handling

Authentication errors will return appropriate HTTP status codes and error messages:

| Status Code | Error Code | Description |
|-------------|------------|-------------|
| 401 | INVALID_CREDENTIALS | Email or password is incorrect |
| 401 | TOKEN_EXPIRED | Access token has expired |
| 401 | INVALID_TOKEN | Token is invalid or malformed |
| 401 | TOKEN_REVOKED | Token has been revoked |
| 403 | INSUFFICIENT_PERMISSIONS | User does not have permission for the requested resource |

## Security Best Practices

1. **Store tokens securely**: Never store tokens in local storage or cookies accessible by JavaScript. Use HTTP-only cookies or secure storage mechanisms.

2. **Use HTTPS**: Always use HTTPS to prevent tokens from being intercepted.

3. **Token validation**: Validate tokens on the server for every request.

4. **Short expiration times**: Use short expiration times for access tokens (1 hour or less).

5. **Refresh token rotation**: Implement refresh token rotation for added security.

## Example: Complete Authentication Flow

### 1. User Login

```javascript
async function login(email, password) {
  const response = await fetch('https://api.yamify.com/v1/auth/login', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ email, password })
  });
  
  const data = await response.json();
  
  if (data.status === 'success') {
    // Store tokens securely
    secureStore.setAccessToken(data.data.accessToken);
    secureStore.setRefreshToken(data.data.refreshToken);
    return data.data.user;
  } else {
    throw new Error(data.error.message);
  }
}
```

### 2. Making Authenticated Requests

```javascript
async function fetchUserProfile() {
  const accessToken = secureStore.getAccessToken();
  
  const response = await fetch('https://api.yamify.com/v1/users/me', {
    headers: {
      'Authorization': `Bearer ${accessToken}`
    }
  });
  
  if (response.status === 401) {
    // Token expired, try to refresh
    const refreshed = await refreshAccessToken();
    if (refreshed) {
      return fetchUserProfile(); // Retry with new token
    } else {
      // Refresh failed, redirect to login
      redirectToLogin();
      return null;
    }
  }
  
  const data = await response.json();
  return data.data.user;
}
```

### 3. Refreshing Access Token

```javascript
async function refreshAccessToken() {
  const refreshToken = secureStore.getRefreshToken();
  
  try {
    const response = await fetch('https://api.yamify.com/v1/auth/refresh', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ refreshToken })
    });
    
    const data = await response.json();
    
    if (data.status === 'success') {
      secureStore.setAccessToken(data.data.accessToken);
      return true;
    } else {
      return false;
    }
  } catch (error) {
    console.error('Error refreshing token:', error);
    return false;
  }
}
```

## Related Information

- For details on API endpoints, see the [API Endpoints](/api-docs/endpoints) page
- For information about user-related endpoints, see the [User Endpoints](/api-docs/endpoints#user-endpoints) section
